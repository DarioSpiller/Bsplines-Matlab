function [a4,a2,a3,a1] = coeff_a_i(U_G,X_i,X_f,D)

if D==6
a4=1/16*(X_f(1,2)+X_i(1,2)-X_f(1,1)+X_i(1,1))-3*U_G(1,2);

a2=(X_f(1,1)-X_i(1,1))/2-a4-sum(U_G(1,2:2:end));

a3=(X_f(1,2)-X_i(1,2))/8-4*U_G(1,1);

a1=(X_f(1,1)+X_i(1,1))/2-a3-sum(U_G(1,1:2:end));

elseif D==5

 a4=1/16*(X_f(1,2)+X_i(1,2)-X_f(1,1)+X_i(1,1));

a2=(X_f(1,1)-X_i(1,1))/2-a4;

a3=(X_f(1,2)-X_i(1,2))/8-4*U_G(1,1);

a1=(X_f(1,1)+X_i(1,1))/2-a3-sum(U_G(1,1:2:end));

elseif D==7
    
a4=1/16*(X_f(1,2)+X_i(1,2)-X_f(1,1)+X_i(1,1))-3*U_G(1,2);

a2=(X_f(1,1)-X_i(1,1))/2-a4-sum(U_G(1,2:2:end));

a3=(X_f(1,2)-X_i(1,2))/8-4*U_G(1,1)-9*U_G(1,3);

a1=(X_f(1,1)+X_i(1,1))/2-a3-sum(U_G(1,1:2:end));

elseif D==8
    
a4=1/16*(X_f(1,2)+X_i(1,2)-X_f(1,1)+X_i(1,1))-3*U_G(1,2)-6*U_G(1,4);

a2=(X_f(1,1)-X_i(1,1))/2-a4-sum(U_G(1,2:2:end));

a3=(X_f(1,2)-X_i(1,2))/8-4*U_G(1,1)-9*U_G(1,3);

a1=(X_f(1,1)+X_i(1,1))/2-a3-sum(U_G(1,1:2:end));

else
a4=1/16*(X_f(1,2)+X_i(1,2)-X_f(1,1)+X_i(1,1))-3*U_G(1,2)-6*U_G(1,4)-10*U_G(1,6);

a2=(X_f(1,1)-X_i(1,1))/2-a4-sum(U_G(1,2:2:end));

a3=(X_f(1,2)-X_i(1,2))/8-4*U_G(1,1)-9*U_G(1,3)-16*U_G(1,5);

a1=(X_f(1,1)+X_i(1,1))/2-a3-sum(U_G(1,1:2:end));
end

end